<!DOCTYPE html> <html> <head> <title>Pjango Documentation > Built-in Libraries > Core > Built-in Tags, Filters, and Middleware > Middleware > Custom Middleware</title> <link rel="stylesheet" type="text/css" href="/home/wqian94/Pjango/documentation/style.css" /> </head> <body> <div style="overflow:hidden;width:0;height:0;">&nbsp;</div> <div class="nav" style="position:fixed;z-index:100;width:251px;height:100%;overflow:auto;border-right:5px ridge black;"> <div class="desc" style="padding:1em 0 0 1em;"> <a href="../../../../index.htm" class="nav" title="Pjango Documentation">Home</a><ul><li><a href="../../../../installation/index.htm" class="nav" title="Installation Guide">Installation</a></li><li><a href="../../../../lib/index.htm" class="nav" title="Built-in Libraries">Libraries</a><ul><li><a href="../../../../lib/including.htm" class="nav" title="Including Library Files">Including Library Files</a></li><li><a href="../../../../lib/core/index.htm" class="nav" title="Core">Core</a><ul><li><a href="../../../../lib/core/core/index.htm" class="nav" title="Core Functions">Core Functions</a></li><li><a href="../../../../lib/core/site/index.htm" class="nav" title="Site Settings">Site Settings</a></li><li><a href="../../../../lib/core/builtins/index.htm" class="nav" title="Built-in Tags, Filters, and Middleware">Tags, Filters, and Middleware</a><ul><li><a href="../../../../lib/core/builtins/filters/index.htm" class="nav" title="Filters">Filters</a></li><li><a href="../../../../lib/core/builtins/middleware/index.htm" class="nav" title="Middleware">Middleware</a><ul><li><a href="../../../../lib/core/builtins/middleware/AbstractMiddleware.htm" class="nav" title="abstract class AbstractMiddleware">AbstractMiddleware</a></li><li><a href="../../../../lib/core/builtins/middleware/builtins.htm" class="nav" title="Built-in Middleware Reference">Built-in Middleware</a></li><li><a href="../../../../lib/core/builtins/middleware/customMiddleware.htm" class="nav highlight"" title="Custom Middleware">Custom Middleware</a></li></ul></li><li><a href="../../../../lib/core/builtins/tags/index.htm" class="nav" title="Tags">Tags</a></li></ul></li></ul></li><li><a href="../../../../lib/sql/index.htm" class="nav" title="SQL">SQL</a></li></ul></li><li><a href="../../../../developing/index.htm" class="nav" title="Development and Documentation">Writing Software</a></li></ul> </div> </div> <div style="margin-left:256px;padding-left:5px;padding-right:1em;overflow:auto;"> <div> <h1>Custom Middleware</h1> <hr /> Middleware is often important but lacking in most packages. In fact, it is often the case that you need to customize your own middleware for your projects.<br /> <br /> Building and using a custom middleware is exceedingly simple: the only requirement is that your middleware class must extend from the <span class="variable">AbstractMiddleware</span> class. Of course, whether the preprocesing and rendering functions are overridden is up to you; without any overrides, a middleware class does absolutely nothing.<br /> <br /> As noted in the <a href="AbstractMiddleware.htm">AbstractMiddleware class</a>, there are only two functions to consider: the <code>preprocess</code> and <code>render</code> functions.<br /> <br /> The <code>preprocess()</code> function is run after all the libraries files in <code>lib/</code> have been included, and before any rendering is done. This is useful for pre-rendering checks, as in the CSRF middleware.<br /> <br /> The <code>render($text)</code> function is run after rendering the template, with the rendered text in the variable <span class="variable">$text</span>. This is essentially post-processing the output. The return value of this function will ultimately be passed on to other middleware before it is outputted to the client.<br /> <br /> In order to use a middleware, add it to the list in <code>settings.php</code>, where the call is made to the <span class="variable">__SITE</span> class's <code>addMiddleware</code> function. Remember that ordering is important. </div> </div> </body> </html>